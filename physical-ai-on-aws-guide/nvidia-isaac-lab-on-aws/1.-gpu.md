---
description: EC2에서 Issac Lab을 위한 환경 세팅
---

# 1. GPU 기반 클라우드 인프라 준비

### 1. Cloudformation 다운로드

이 CloudFormation 템플릿은 **NVIDIA Isaac Lab**을 위한 AWS 인프라를 구축하는 템플릿입니다. 로봇 시뮬레이션 및 강화학습을 위한 GPU 기반 개발 환경을 프로비저닝 합니다.

{% file src="../../.gitbook/assets/IsaacLabEnvSetup (2).yml" %}

{% file src="../../.gitbook/assets/IsaacLabEnvSetupHumble.yml" %}

<details>

<summary>Cloudformation 템플릿 내용</summary>

:link: **파라미터 (사용자 선택 옵션)**

1. **InferenceInstanceType**: GPU 인스턴스 타입 선택 (g6.4xlarge \~ g6e.12xlarge)
2. **ROSVersion**: ROS 버전 선택 (ROS1 Melodic/Noetic, ROS2 Foxy/Humble 등)
3. **Simulator**: 시뮬레이터 선택 (Gazebo, Carla, None)
4. **ECSBaseAMI**: AWS Batch용 베이스 AMI

**🏗️ 인프라 구성**

1. **네트워킹 설정**

```
VPC (10.0.0.0/16)
├─ Public Subnet (10.0.0.0/24) - DCV 인스턴스용
├─ Private Subnet (10.0.1.0/24) - AWS Batch용
├─ Internet Gateway
├─ NAT Gateway
└─ S3 VPC Endpoint
```

2. **EC2 인스턴스 (InferenceInstance)**

* GPU 인스턴스에 다음을 자동 설치:
  * Ubuntu Desktop (GNOME)
  * NICE DCV (원격 데스크톱)
  * ROS (선택한 버전)
  * Docker + NVIDIA Container Toolkit
  * 시뮬레이터 (선택 시)
  * NVIDIA Isaac Lab

3. **EFS (Elastic File System)**

* 데이터 공유를 위한 네트워크 파일 시스템
* `/home/ubuntu/environment/efs`에 마운트

4. **보안 그룹**

* SSH (포트 22)
* DCV (포트 8080, 8443)

**🚀 자동 설치 프로세스 (UserData)**

인스턴스 생성 시 다음을 순차적으로 실행

1. **시스템 업데이트**
2. **Desktop 환경** 설치
3. **DCV 서버** 설치 및 구성
4. **ROS** 설치 (선택한 버전)
5. **Docker** 설치
6. **시뮬레이터** 설치 (선택 시)
7. **NVIDIA 드라이버** (535-server)
8. **NVIDIA Container Toolkit**
9. **EFS 마운트**
10. **Isaac Lab 설치**
    * GitHub에서 클론
    * Docker 이미지 빌드
    * ECR에 푸시

**🔐 보안 설정**

* **Secrets Manager**: 인스턴스 접속 비밀번호 저장
* **IAM Roles**:
  * EC2용 역할 (S3, ECR, EFS, SSM 접근)
  * Batch용 역할
* **VPC Flow Logs**: 거부된 트래픽 로깅

**📤 출력값 (Outputs)**

* **EC2Host**: 인스턴스 ID
* **DCVURL**: DCV 접속 URL (`https://<Public-IP>:8443`)
* **LogGroupName/ARN**: CloudWatch Logs 정보

</details>

***

### 2. Cloudformation 배포

<figure><img src="../../.gitbook/assets/image (1).png" alt=""><figcaption></figcaption></figure>

AWS 콘솔에서 `Cloudformation` 에 접속하고, `Create stack` 버튼을 선택합니다.

<figure><img src="../../.gitbook/assets/image (2).png" alt=""><figcaption></figcaption></figure>

`Choose an existing template` -> `Ùpload a template file` 에서 위에 다운로드 받은 템플릿 파일을 업로드 하세요.

<figure><img src="../../.gitbook/assets/image (3).png" alt=""><figcaption></figcaption></figure>

아래와 같이 Parameters 값을 입력하세요:

* **Stack Name:** `IsaacLab`
* **InferenceInstanceType:** `g6.12xlarge`
* **EC2BaseAMI**: 사용하려는 ECS 최적화 GPU 인스턴스의 AMI ID
* **ROSVersion:** `ROS2Foxy`
* **Simulator:** `None`

<figure><img src="../../.gitbook/assets/image (4).png" alt=""><figcaption></figcaption></figure>

약 40분 후 프로비저닝이 완료되면, Output에서 아래 항목들을 확인할 수 있습니다:

* **EC2Host**: 인스턴스 ID
* **DCVURL**: DCV 접속 URL (`https://<Public-IP>:8443`)
* **LogGroupName/ARN**: CloudWatch Logs 정보
